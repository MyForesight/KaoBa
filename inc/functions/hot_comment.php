<?php
//按时间获得评论数最多的文章
function hot_comment_viewed($number, $days){    global $wpdb;    $sql = "SELECT ID , post_title ,post_content,comment_count           FROM $wpdb->posts           WHERE post_type = 'post' AND post_status = 'publish' AND TO_DAYS(now()) - TO_DAYS(post_date) < $days           ORDER BY comment_count DESC LIMIT 0 , $number ";    $posts = $wpdb->get_results($sql);    $output = "";    foreach ($posts as $post){		$outputimg = preg_match_all('/<img.+src=[\'"]([^\'"]+)[\'"].*>/i', $post->post_content, $matches);		$first_img = $matches [1] [0];		if(empty($first_img)){ 		$random = mt_rand(1, 10);			$first_img="" . get_bloginfo('template_directory') . "/images/random/".$random.".jpg";  }        $output .= "<a class=\"top_post_item ping_post\" href= \"".get_permalink($post->ID)."\" title=\"".$post->post_title." (".$post->comment_count."条评论)\" alt=\"".$post->post_title."\"  style=\"display: block;\"  target=\"_blank\"><img src=\"".$first_img."\"><p>".$post->post_title."</p><div class=\"clear\"></div></a>";    }    echo $output;}